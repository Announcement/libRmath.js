//https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Cauchy.html
const libR = require('../dist/lib/libR.js');
const { Normal, Cauchy, rng: { MersenneTwister } } = libR;
// some usefull tools
const { arrayrify } = libR.R;
const log = arrayrify(Math.log);
const seq = libR.R.seq()();

//initialize Cauchy
const defaultCauchy = Cauchy();
const mt = new MersenneTwister(0);
const cauchy1 = Cauchy(mt);

const { dcauchy, pcauchy, qcauchy, rcauchy } = cauchy1;

//1.
dcauchy(seq(-4, 4, 2), -2, 0.5);
/*
[ 0.03744822190397537,
  0.6366197723675814,
  0.03744822190397537,
  0.009794150344116638,
  0.00439048118874194 ]
*/

/*
> dcauchy(seq(-4,4,2), location=-2, scale=0.5);
[1] 0.037448222 0.636619772 0.037448222 0.009794150 0.004390481
*/
//2.
dcauchy(seq(-4, 4, 2), -2, 0.5, true);
/*
[ -3.284796049345671,
  -0.4515827052894548,
  -3.284796049345671,
  -4.625969975185092,
  -5.42831644771003 ]

dcauchy(seq(-4,4,2), location=-2, scale=0.5, log=TRUE);
[1] -3.2847960 -0.4515827 -3.2847960 -4.6259700 -5.4283164

*/
//3.
dcauchy(seq(-4, 4, 2), 0, 2);
/*[ 0.03183098861837907,
  0.07957747154594767,
  0.15915494309189535,
  0.07957747154594767,
  0.03183098861837907 ]
  
> dcauchy(seq(-4,4,2), location=0, scale=2);
[1] 0.03183099 0.07957747 0.15915494 0.07957747 0.03183099  
*/

//1
pcauchy(seq(-4, 4, 2), -2, 0.5);
/*
[ 0.07797913037736932,
  0.5,
  0.9220208696226306,
  0.9604165758394345,
  0.9735353239404101 ]

  dcauchy(seq(-4,4,2), location=-2, scale=0.5);
  [1] 0.07797913 0.50000000 0.92202087 0.96041658 0.97353532
*/

//2.
pcauchy(seq(-4, 4, 2), -2, 0.5, true);
/*
[ 0.07797913037736932,
  0.5,
  0.9220208696226306,
  0.9604165758394345,
  0.9735353239404101 ]

  [1] -2.55131405 -0.69314718 -0.08118742 -0.04038816 -0.02682117
*/

//3.
pcauchy(seq(-4, 4, 2), 0, 2);
/*[ 
  0.14758361765043326, 
  0.25, 
  0.5, 
  0.75, 
  0.8524163823495667 ]

  > pcauchy(seq(-4,4,2), location=0, scale=2);
  [1] 0.1475836 0.2500000 0.5000000 0.7500000 0.8524164
*/


qcauchy(pcauchy(seq(-4, 4, 2), -2, 0.5), -2, 0.5);
/*[ -4,
  -2,
  -8.881784197001252e-16, ==> 0
  2.000000000000006, ==> 2
  3.999999999999992 ] ==> 4
*/

//2.
qcauchy(pcauchy(seq(-4, 4, 2), -2, 0.5, true), -2, 0.5, true);
/*
[
   -4,
  -2,
  -8.881784197001252e-16,
  2.000000000000006,
  3.999999999999992
]
*/

//3.
qcauchy(pcauchy(seq(-4, 4, 2), 0, 2), 0, 2);
/*
[ -4.000000000000001,
  -2.0000000000000004,
  0,
  2.0000000000000004,
  4.000000000000001 ]
*/

//1.
rcauchy(5, 0, 0.5);
/*
[ -0.16821519851781444,
  0.5512599516629566,
  1.1769152991110212,
  -2.146313122236451,
  -0.14832127864320446 
*/

//2.
rcauchy(5, 2, 2);
/*[
  3.4692937226517686,
  1.3389560106559817,
  1.6488412505516226,
  -1.6164861613921215,
  -2.657248785268937
]*/

rcauchy(5, -2, 0.25);
/*
[ -1.950854390465352,
  -1.8110950021419057,
  -1.8451129201960255,
  -2.3753683147740747,
  -1.343986547467857 ]
*/